name: Azure App Service - contentfulappjs(Production), Build and deploy NodeJS app

on:
  workflow_dispatch:
    inputs:
      rgName:
        description: "resource group name"
        required: true
      location:
        description: "Azure location"
        required: true
  #push:
    #branches:
      #- dependabot/npm_and_yarn/ini-1.3.7

jobs:  
  Infra-vnet:
    runs-on: ubuntu-latest

    steps:  
      - uses: hashicorp/setup-terraform@v1.2.1

      - name: Run terraform init
        id: init
        run: terraform init
        working-directory: Terraform/vnet

      - name: Run terraform apply
        id: apply
        run: terraform plan -var="rgName=${{ github.event.inputs.rgName }}" -var="location=${{ github.event.inputs.location }}"
        working-directory: Terraform/vnet